<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Community | PetVerse</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <style>
    .community-container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 2rem;
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 2rem;
    }

    .chat-section, .ai-assistant {
      background: var(--white);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 1.5rem;
    }

    .chat-header {
      border-bottom: 2px solid var(--background);
      padding-bottom: 1rem;
      margin-bottom: 1rem;
    }

    .chat-messages {
      height: 400px;
      overflow-y: auto;
      margin-bottom: 1rem;
      padding: 1rem;
      background: var(--background);
      border-radius: var(--radius);
    }

    .message {
      margin-bottom: 1rem;
      padding: 0.8rem;
      border-radius: var(--radius);
      max-width: 80%;
      animation: fadeIn 0.3s ease-in;
    }

    .message.user {
      background: var(--primary-light);
      color: var(--white);
      margin-left: auto;
    }

    .message.other {
      background: var(--background);
      color: var(--text);
    }

    .message.ai {
      background: var(--accent);
      color: var(--white);
    }

    .chat-input {
      display: flex;
      gap: 1rem;
    }

    .chat-input input {
      flex: 1;
      padding: 0.8rem;
      border: 2px solid var(--primary-light);
      border-radius: var(--radius);
    }

    .chat-input button {
      background: var(--primary);
      color: var(--white);
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: var(--radius);
      cursor: pointer;
    }

    .ai-assistant {
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      color: var(--white);
    }

    .ai-input {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .ai-input input {
      flex: 1;
      padding: 0.5rem;
      border: none;
      border-radius: var(--radius);
    }

    .posts-section {
      grid-column: 1 / -1;
      background: var(--white);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 1.5rem;
      margin-top: 2rem;
    }

    .post {
      border: 1px solid var(--primary-light);
      border-radius: var(--radius);
      padding: 1rem;
      margin-bottom: 1rem;
    }

    .post-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .post-actions {
      display: flex;
      gap: 1rem;
      margin-top: 0.5rem;
    }

    .post-actions button {
      background: none;
      border: none;
      color: var(--text-light);
      cursor: pointer;
    }

    .clear-chat-btn {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 1px solid white;
      padding: 0.3rem 0.8rem;
      border-radius: var(--radius);
      font-size: 0.8rem;
      cursor: pointer;
      margin-left: 1rem;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 768px) {
      .community-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  Â  <nav class="navbar">
    Â  Â  <div class="logo">PetVerse ğŸ¾</div>
Â  Â  <ul>
Â  Â  Â  <li><a href="index.html" data-i18n="nav_home">Home</a></li>
Â  Â  Â  <li><a href="pets.html" data-i18n="nav_adopt">Adopt</a></li>
Â  Â  Â  <li><a href="volunteer.html" data-i18n="nav_volunteer">Volunteer</a></li>
Â  Â  Â  <li><a href="donate.html" data-i18n="nav_donate">Donate</a></li>
Â  Â  Â  <li><a href="community.html" style="color: var(--primary);" data-i18n="nav_community">Community</a></li>
Â  Â  Â  <li><a href="lost-found.html" data-i18n="nav_lost_found">Lost & Found</a></li>
Â  Â  Â  <li><a href="login.html" id="loginLink" data-i18n="nav_login">Login / Signup</a></li>
Â  Â  Â  <li><a href="myadoptions.html" data-i18n="nav_my_adoptions">My Adoptions</a></li>
Â  Â  Â  <li id="logoutItem" style="display: none;">
Â  Â  Â  Â  <a href="javascript:void(0)" id="logoutLink" style="color: var(--secondary);" data-i18n="nav_logout">Logout</a>
Â  Â  Â  </li>
Â  Â  Â  <li>
Â  Â  Â  Â  <select id="languageSelect" onchange="changeLanguage(this.value)" style="background: var(--primary-light); color: white; border: none; padding: 0.5rem; border-radius: var(--radius);">
Â  Â  Â  Â  Â  <option value="en">English</option>
Â  Â  Â  Â  Â  <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
Â  Â  Â  Â  Â  <option value="kn">à²•à²¨à³à²¨à²¡</option>
Â  Â  Â  Â  </select>
Â  Â  Â  </li>
Â  Â  </ul>
Â  </nav>
Â  <div class="hero">
    Â  </div>
Â  <div class="community-container">
    Â  Â  <div class="chat-section">
Â  Â  Â  <div class="chat-header">
Â  Â  Â  Â  <h3 data-i18n="community_chat">Community Chat</h3>
Â  Â  Â  Â  <p>Chat with other pet owners in real-time</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="chat-messages" id="chatMessages">
Â  Â  Â  Â  <div class="message other">
Â  Â  Â  Â  Â  <strong>Admin:</strong> Welcome to PetVerse Community! Feel free to ask questions and share your pet stories.
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="chat-input">
Â  Â  Â  Â  <input type="text" id="chatInput" placeholder="Type your message..." data-i18n="type_message">
Â  Â  Â  Â  <button onclick="sendMessage()" data-i18n="send_button">Send</button>
Â  Â  Â  </div>
Â  Â  </div>
    Â  Â  <div class="ai-assistant">
Â  Â  Â  <div class="chat-header">
Â  Â  Â  Â  <div style="display: flex; justify-content: space-between; align-items: center;">
Â  Â  Â  Â  Â  <h3 data-i18n="ai_assistant">ğŸ¤– Pet AI Assistant</h3>
Â  Â  Â  Â  Â  <button class="clear-chat-btn" onclick="clearAIChat()" data-i18n="clear_chat">Clear Chat</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <p>Get instant answers to your pet care questions</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="chat-messages" id="aiMessages">
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  <div class="ai-input">
Â  Â  Â  Â  <input type="text" id="aiInput" placeholder="Ask about pet care..." data-i18n="ask_ai_placeholder">
Â  Â  Â  Â  <button onclick="askAI()" data-i18n="ask_button">Ask</button>
Â  Â  Â  </div>
Â  Â  </div>
    Â  Â  <div class="posts-section">
Â  Â  Â  <div class="chat-header">
Â  Â  Â  Â  <h3 data-i18n="community_posts">Community Posts</h3>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <input type="text" id="postTitle" placeholder="Post title" data-i18n="post_title_placeholder" style="margin-right: 1rem; padding: 0.5rem; border: 1px solid var(--primary-light); border-radius: var(--radius);">
Â  Â  Â  Â  Â  <textarea id="postContent" placeholder="Share your experience..." data-i18n="post_content_placeholder" style="width: 100%; padding: 0.5rem; border: 1px solid var(--primary-light); border-radius: var(--radius); margin: 0.5rem 0;"></textarea>
Â  Â  Â  Â  Â  <button onclick="createPost()" style="background: var(--primary); color: white; border: none; padding: 0.5rem 1rem; border-radius: var(--radius); cursor: pointer;" data-i18n="create_post">Create Post</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div id="postsContainer">
Â  Â  Â  Â  <div class="post">
Â  Â  Â  Â  Â  <div class="post-header">
Â  Â  Â  Â  Â  Â  <strong>My first week with Bruno! ğŸ•</strong>
Â  Â  Â  Â  Â  Â  <span style="color: var(--text-light); font-size: 0.9rem;">Posted by: Sarah</span>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <p>Bruno has settled in so well! He loves his new bed and enjoys our evening walks. Any tips for leash training?</p>
Â  Â  Â  Â  Â  <div class="post-actions">
Â  Â  Â  Â  Â  Â  <button onclick="likePost(this)">ğŸ‘ Like (3)</button>
Â  Â  Â  Â  Â  Â  <button onclick="toggleComments(this)">ğŸ’¬ Comment (2)</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  Â  <div id="toast" class="toast"></div>
  <script src="/auth.js"></script>
  <script src="/translations.js"></script>

  Â  <script>
Â  Â  // ========== AI KNOWLEDGE BASE (KEPT) ==========
Â  Â  const aiKnowledgeBase = {
Â  Â  Â  Â  'food': "For pet food, I recommend high-quality commercial pet food...",
        // ... (all your knowledge base entries are safe)
Â  Â  Â  Â  'default': "I'd be happy to help with that! ..."
Â  Â  };

Â  Â  // ========== CHAT HISTORY MANAGEMENT (KEPT) ==========
Â  Â  function saveAIChatHistory() {
        // ... (your code is safe)
Â  Â  }

Â  Â  function loadAIChatHistory() {
        // ... (your code is safe)
Â  Â  }

Â  Â  function clearAIChat() {
Â  Â  Â  Â  if (confirm('Are you sure you want to clear the chat history?')) {
Â  Â  Â  Â  Â  Â  localStorage.removeItem('petverse_ai_chat_history');
Â  Â  Â  Â  Â  Â  loadAIChatHistory();
            // This now calls the GLOBAL showToast() from auth.js
Â  Â  Â  Â  Â  Â  showToast('Chat history cleared');
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function addAIMessage(message, isUser = false) {
        // ... (your code is safe)
Â  Â  }

Â  Â  // ========== AI CHAT FUNCTION (KEPT) ==========
Â  Â  function askAI() {
        // ... (your code is safe)
Â  Â  }

Â  Â  // ========== COMMUNITY FUNCTIONS (KEPT) ==========
Â  Â  function sendMessage() {
        // ... (your code is safe)
Â  Â  }

Â  Â  function createPost() {
        // ... (your code is safe)
Â  Â  Â  Â  const user = localStorage.getItem("petpal_user");
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (!user) {
            // This now calls the GLOBAL showToast()
Â  Â  Â  Â  Â  Â  showToast("Please login to create a post");
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  // ... (rest of your createPost logic is safe)
        // ...
Â  Â  Â  Â  showToast("Post created successfully!");
Â  Â  }

Â  Â  function likePost(button) {
Â  Â  Â  Â  const user = localStorage.getItem("petpal_user");
Â  S Â  Â  if (!user) {
            // This now calls the GLOBAL showToast()
Â  Â  Â  Â  Â  Â  showToast("Please login to like posts");
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  // ... (rest of your likePost logic is safe)
Â  Â  }

Â  Â  function toggleComments(button) {
        // This now calls the GLOBAL showToast()
Â  Â  Â  Â  showToast("Comment feature coming soon!");
Â  Â  }

Â  Â  // ========== AUTH FUNCTIONS (DELETED) ==========
Â  Â  // function updateAuthLinks() { ... }  <- REMOVED (now in auth.js)
Â  Â  // function logout() { ... }            <- REMOVED (now in auth.js)
Â  Â  // function showToast(message) { ... }  <- REMOVED (now in auth.js)

Â  Â  // ========== EVENT LISTENERS (KEPT) ==========
Â  Â  document.getElementById('chatInput').addEventListener('keypress', function(e) {
Â  Â  Â  Â  if (e.key === 'Enter') sendMessage();
Â  Â  });

Â  Â  document.getElementById('aiInput').addEventListener('keypress', function(e) {
Â  Â  Â  Â  if (e.key === 'Enter') askAI();
Â  S });

Â  Â  // ========== ENHANCED INITIALIZATION (MODIFIED) ==========
Â  Â  document.addEventListener('DOMContentLoaded', function() {
Â  Â  Â  Â  console.log('Initializing community page...');
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Initialize auth
Â  Â  Â  Â  // updateAuthLinks(); <- REMOVED (auth.js does this automatically)
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Load AI chat history (Your code is safe)
Â  Â  Â  Â  let retryCount = 0;
Â  Â  Â  Â  const maxRetries = 3;
Â  Â  Â  Â Â 
Â  Â  Â  Â  function initializeChat() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  loadAIChatHistory();
Â  Â  Â  Â  Â  Â  Â  Â  console.log('Chat initialized successfully');
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Chat initialization failed:', error);
Â  Â  Â  Â  Â  Â  Â  Â  if (retryCount < maxRetries) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  retryCount++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`Retrying chat initialization (${retryCount}/${maxRetries})...`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(initializeChat, 500);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  initializeChat();
Â  Â  Â  Â Â 
Â  Â  Â  Â  // All your other init logic is safe
Â  Â  Â  Â  window.addEventListener('beforeunload', saveAIChatHistory);
Â  Â  Â  Â  setInterval(saveAIChatHistory, 30000);
Â  Â  Â  Â Â 
Â  Â  Â  Â  console.log('Community page fully initialized');
Â  Â  });

Â  Â  // ========== GLOBAL TRANSLATION SUPPORT (DELETED) ==========
Â  Â  // function changeLanguage(lang) { ... } <- REMOVED (now in translations.js)
Â  </script>

Â  Â  </body>
</html>
